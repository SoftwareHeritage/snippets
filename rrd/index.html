<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>SWH Objects history</title>
    <link href="../examples.css" rel="stylesheet" type="text/css">
    <!--[if lte IE 8]><script language="javascript" type="text/javascript" src="../../excanvas.min.js"></script><![endif]-->
    <script language="javascript" type="text/javascript" src="../../jquery.js"></script>
    <script language="javascript" type="text/javascript" src="../../jquery.flot.js"></script>
    <script language="javascript" type="text/javascript" src="../../jquery.flot.time.js"></script>
    <script type="text/javascript">
      url = 'http://127.0.0.1:6543/api/1/stat/history/'

      /* Load the graph with the dictionary data */
      var load_graph = function(data) {
            datasets = []
            for (var legend in data) {
              dataset = {
                'label': legend,
                'data': data[legend],
              }
              datasets.push(dataset)
            }

            $.plot("#placeholder", datasets, {
                xaxis: {
                  mode: "time",
                  minTickSize: [1, "day"],
                  color: "black",
                  position: "bottom",
                  axisLabel: "Time",
                  axisLabelUseCanvas: true,
                  axisLabelFontSizePixels: 12,
                  axisLabelFontFamily: 'Verdana, Arial',
                  axisLabelPadding: 0
                },
                yaxis: {
                  color: "black",
                  axisLabel: "Quantity",
                  axisLabelUseCanvas: true,
                  axisLabelFontSizePixels: 12,
                  axisLabelFontFamily: 'Verdana, Arial',
                  axisLabelPadding: 0
                }
            });

            // Add the Flot version string to the footer
            $("#footer").append(" &ndash; Flot " + $.plot.version);
         }

      /* Do the actual query to retrieve the data dictionary */
      $.ajax({
        type: 'GET',
         url: url,
         jsonpCallback: 'swhdata',
         contentType: "application/json",
         dataType: 'jsonp',
         success: load_graph,
         error: function(e) {
            console.log(e);
         }
     });
      </script>
  </head>
  <body>

    <div id="header">
      <h2>Software Heritage Objects</h2>
    </div>

    <div id="content">

      <div class="demo-container">
	<div id="placeholder" class="demo-placeholder"></div>
      </div>

    </div>

    <div id="footer">
      Copyright &copy; 2016 Software Heritage
    </div>

  </body>
</html>
